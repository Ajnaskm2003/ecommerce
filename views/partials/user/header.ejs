<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="img/fav.png">
    <meta name="author" content="CodePixar">
    <meta charset="UTF-8">
    <title>Karma Shop</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/linearicons.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/main.css">

    <style>
        .emplogo {
            width: 130px;
            height: auto;
            transition: transform 0.3s ease;
        }
        .emplogo:hover { transform: scale(1.08); }

        .header_area {
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            padding: 10px 0;
        }
        .header_area.sticky-header {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 8px 0;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

        .header-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .navbar-nav .nav-item { margin: 0 18px; }
        .navbar-nav .nav-link {
            font-size: 1.05rem;
            font-weight: 500;
            color: #333;
            padding: 8px 0 !important;
            position: relative;
            transition: color 0.3s ease;
        }
        .navbar-nav .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background: linear-gradient(90deg, #e74c3c, #c0392b);
            transition: width 0.3s ease, left 0.3s ease;
            border-radius: 2px;
        }
        .navbar-nav .nav-link:hover::after,
        .navbar-nav .nav-item.active .nav-link::after {
            width: 100%;
            left: 0;
        }
        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-item.active .nav-link {
            color: #e74c3c;
        }

        .navbar-right .nav-item { margin-left: 20px; }
        .navbar-right .nav-link {
            font-size: 1.35rem !important;
            color: #444;
            transition: all 0.3s ease;
            position: relative;
        }
        .navbar-right .nav-link:hover {
            color: #e74c3c;
            transform: translateY(-2px) scale(1.08);
        }

        .navbar-right .nav-link::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: -28px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: #fff;
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
            pointer-events: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        .navbar-right .nav-link:hover::before {
            opacity: 1;
            visibility: visible;
        }

        .user-profile {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #eee;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        .user-profile:hover {
            border-color: #e74c3c;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(231, 60, 60, 0.25);
        }

        @media (max-width: 991px) {
            .navbar-nav .nav-item { margin: 10px 0; }
            .navbar-right .nav-item { margin-left: 16px; }
            .navbar-right .nav-link { font-size: 1.25rem !important; }
            .user-profile { width: 34px; height: 34px; }
            .header-container { max-width: 100%; }
        }
    </style>
</head>

<body>

    <header class="header_area sticky-header">
        <div class="main_menu">
            <nav class="navbar navbar-expand-lg navbar-light">
                <div class="header-container d-flex justify-content-between align-items-center w-100">

                    <!-- Logo -->
                    <a class="navbar-brand logo_h" href="/">
                        <img class="emplogo" src="/img/emplogo.png" alt="Karma Shop">
                    </a>

                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="nav navbar-nav menu_nav mx-auto">
                            <li class="nav-item active"><a class="nav-link" href="/">HOME</a></li>
                            <li class="nav-item"><a class="nav-link" href="/shop">SHOP</a></li>

                            <% if (typeof user !== 'undefined' && user) { %>
                                <li class="nav-item"><a class="nav-link" href="/logout">LOGOUT</a></li>
                            <% } else { %>
                                <li class="nav-item"><a class="nav-link" href="/signup">SIGN UP</a></li>
                            <% } %>
                        </ul>

                        <ul class="nav navbar-nav navbar-right d-flex align-items-center">
                            <li class="nav-item">
                                <a href="/cart" class="nav-link" data-tooltip="My Cart">
                                    <span class="ti-shopping-cart"></span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/wishlist" class="nav-link" data-tooltip="Wishlist">
                                    <span class="ti-heart"></span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/userProfile">
                                    <img class="user-profile" src="/img/logo prf.jpg" alt="Profile" data-tooltip="My Profile">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- BLOCK CHECKER SCRIPT - ONLY FOR LOGGED-IN USERS -->
    <% if (typeof user !== 'undefined' && user) { %>
    <script>
        // Check every 7 seconds if user is blocked
        const checkBlockStatus = async () => {
            try {
                const res = await fetch('/api/check-block-status', {
                    method: 'GET',
                    credentials: 'include',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                if (res.status === 401 || res.status === 403) {
                    alert('Your account has been blocked by the admin.');
                    window.location.href = '/signin?blocked=true';
                }
            } catch (err) {
                console.log('Block check failed (offline?)');
            }
        };

        // Start checking immediately and every 7 seconds
        checkBlockStatus();
        setInterval(checkBlockStatus, 7000);
    </script>
    <% } %>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>