<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Order Details</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f7fa; min-height: 100vh; padding: 40px 20px; }
    .container { max-width: 1400px; margin: 0 auto; }
    .box { background: #ffffff; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
    .success-header { background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%); padding: 30px 50px; color: white; display: flex; align-items: center; justify-content: space-between; }
    .success-header-left { display: flex; align-items: center; gap: 20px; }
    .success-icon { width: 60px; height: 60px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; animation: scaleIn 0.5s ease; }
    @keyframes scaleIn { from { transform: scale(0); } to { transform: scale(1); } }
    .success-icon svg { width: 35px; height: 35px; stroke: #4CAF50; stroke-width: 3; }
    .success-text h1 { font-size: 28px; margin-bottom: 5px; }
    .success-text p { font-size: 14px; opacity: 0.9; }
    .success-header-right { text-align: right; }
    .order-id { font-size: 14px; opacity: 0.9; margin-bottom: 5px; }
    .order-date { font-size: 20px; font-weight: 600; }
    .badge { display: inline-block; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; margin-top: 8px; }
    .Pending { background-color: #ff9800; color: white; }
    .Processing { background-color: #2196f3; color: white; }
    .Shipped { background-color: #9c27b0; color: white; }
    .Delivered { background-color: #4caf50; color: white; }
    .Cancelled { background-color: #f44336; color: white; }
    .error-message { text-align: center; color: #dc3545; font-size: 28px; font-weight: bold; padding: 60px; }
    .content-wrapper { display: grid; grid-template-columns: 1fr 380px; gap: 0; }
    .products-section { padding: 40px 50px; border-right: 1px solid #e0e0e0; }
    .section-title { font-size: 22px; font-weight: 600; color: #2d3748; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }
    .section-title svg { width: 24px; height: 24px; stroke: #4CAF50; }
    .product-list { display: flex; flex-direction: column; gap: 20px; }
    .product { display: flex; gap: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 2px solid transparent; transition: all 0.3s ease; }
    .product:hover { border-color: #4CAF50; background: #f1f8e9; transform: translateX(5px); }
    .product-image { width: 100px; height: 100px; border-radius: 8px; overflow: hidden; background: white; flex-shrink: 0; }
    .product-image img { width: 100%; height: 100%; object-fit: cover; }
    .product-details { flex: 1; display: flex; flex-direction: column; justify-content: center; }
    .product-details h4 { font-size: 18px; color: #2d3748; margin-bottom: 8px; }
    .product-details p { font-size: 14px; color: #718096; margin-bottom: 4px; }
    .product-details p strong { color: #2d3748; font-weight: 600; }
    .product-price { font-size: 20px; font-weight: 700; color: #4CAF50; margin-top: 8px; }
    .sidebar { background: #f8f9fa; padding: 40px 30px; }
    .info-card { background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #4CAF50; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .info-card h3 { font-size: 16px; color: #4CAF50; margin-bottom: 15px; font-weight: 600; }
    .info-card p { font-size: 14px; color: #2d3748; margin-bottom: 8px; line-height: 1.6; }
    .info-card strong { color: #4CAF50; font-weight: 600; }
    .order-summary-card { background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%); color: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; }
    .order-summary-card h3 { font-size: 16px; margin-bottom: 15px; font-weight: 600; }
    .order-summary-card p { font-size: 14px; margin-bottom: 8px; opacity: 0.95; }
    .total-amount { font-size: 24px !important; font-weight: 700 !important; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.3); }
    .button-group { text-align: center; margin-top: 20px; }
    .btn { display: inline-block; padding: 14px 40px; background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3); }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4); }
  </style>
</head>
<body>
  <div class="container">
    <div class="box">

      <% if (error) { %>
        <div class="error-message">
          <h2>‚ö† <%= error %></h2>
          <p>Unable to find the order details.</p>
        </div>
      <% } else if (order) { %>
        <!-- Header -->
        <div class="success-header">
          <div class="success-header-left">
            <div class="success-icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <div class="success-text">
              <h1>Order Confirmed!</h1>
              <p>Your order has been successfully placed</p>
            </div>
          </div>
          <div class="success-header-right">
            <div class="order-id">Order ID: <%= order.orderId %></div>
            <div class="order-date"><%= new Date(order.createdOn).toLocaleDateString() %></div>
            <span class="badge <%= order.status.replace(' ', '') %>"><%= order.status %></span>
          </div>
        </div>

        <!-- Main Content -->
        <div class="content-wrapper">
          <!-- Products Section -->
          <div class="products-section">
            <div class="section-title">
              <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
              </svg>
              Products Ordered
            </div>

            <div class="product-list">
              <% order.orderItems.forEach(item => { %>
                <div class="product">
                  <div class="product-image">
                    <!-- FIXED: No extra /uploads/ prefix ‚Äì matches your working page -->
                    <img src="<%= item.product.image %>" 
                         alt="<%= item.product.name %>" 
                         onerror="this.src='/uploads/default-product.jpg'">
                  </div>
                  <div class="product-details">
                    <h4><%= item.product.name %></h4>
                    <p><strong>Size:</strong> <%= item.size %></p>
                    <p><strong>Quantity:</strong> <%= item.quantity %></p>
                    <div class="product-price">‚Çπ<%= item.subtotal.toFixed(2) %></div>
                  </div>
                </div>
              <% }) %>
            </div>
          </div>

          <!-- Sidebar -->
          <div class="sidebar">
            <div class="info-card">
              <h3>üìç Shipping Address</h3>
              <p><strong><%= order.address.fullname %></strong></p>
              <p><%= order.address.street %></p>
              <p><%= order.address.city %>, <%= order.address.state %></p>
              <p><%= order.address.zipCode %></p>
              <p><strong>Phone:</strong> <%= order.address.phone %></p>
            </div>

            <div class="order-summary-card">
              <h3>Order Summary</h3>
              <p><strong>Payment Method:</strong> <%= order.paymentMethod %></p>
              <p class="total-amount">‚Çπ<%= order.totalAmount.toFixed(2) %></p>
            </div>

            <div class="button-group">
              <a href="/orders" class="btn">View All Orders</a>
            </div>
          </div>
        </div>

      <% } else { %>
        <div class="error-message">‚ö† Order data not found.</div>
      <% } %>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>